(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{"./src/models/repo.js":function(e,t,n){"use strict";n.r(t);var a=n("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),r=n.n(a),s=n("./node_modules/@babel/runtime/regenerator/index.js"),o=n.n(s),c=n("./node_modules/@babel/runtime/helpers/asyncToGenerator.js"),i=n.n(c),u=n("./node_modules/@rematch/core/dist/umd/rematch.prod.min.js"),p=n("./src/utils/request.js"),d=n("./src/utils/utils.js"),l=n("./src/history.js");t.default={state:{detail:{},detailEdit:!1,fileDetail:null,reference:"master",readmeContent:"",reposTree:{},repos:{page:1,pages:2,count:0,rows:[]}},reducers:{updateState:function(e,t){return Object.assign({},e,t)}},effects:{getRepoDetail:function(e){var t=this;return i()(o.a.mark(function n(){var a,r,s,c;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(p.a)("/api/repos/".concat(e.owner,"/").concat(e.repo));case 2:return a=n.sent,n.next=5,Object(p.a)("/api/repos/".concat(a.id,"/tree"),{body:e});case 5:r=n.sent,s=null,r.tree=r.tree.map(function(t){t.path&&t.name&&/readme.(md|markdown)$/.test(t.name.toLowerCase())&&(s=t.path);var n="";return n=e.path?"master/".concat(e.path,"/").concat(t.name):"master/".concat(t.name),"commit"===t.type&&(n="tree/".concat(t.id)),"blob"!==t.type&&"tree"!==t.type||(n="".concat(t.type,"/").concat(n)),{icon:t.type,content:{name:t.name,id:t.id,type:t.type,path:"/".concat(e.owner,"/").concat(e.repo,"/").concat(n)},size:t.size&&Object(d.a)(t.size),message:{path:"/".concat(e.owner,"/").concat(e.repo,"/commit/").concat(t.sha),message:t.message},age:t.committer&&t.committer.relativedate}}),c={detail:a,reposTree:r},s||r.isFile?u.dispatch.repo.getRepoDetailFileDetail(Object.assign({},e,{path:s||r.path})):c.fileDetail=null,r.content&&(c.readmeContent=r.content),t.updateState(c);case 12:case"end":return n.stop()}},n,this)}))()},getRepoDetailFileDetail:function(e){var t=this;return i()(o.a.mark(function n(){var a,r,s,c,i,d,l;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=Object(u.getState)(),r=a.repo.reference,s=e.owner,c=e.repo,i=e.branch,d=e.path,n.next=4,Object(p.a)("/api/repos/".concat(s,"/").concat(c,"/blob/").concat(i||r,"/").concat(d));case 4:l=n.sent,t.updateState({fileDetail:l});case 6:case"end":return n.stop()}},n,this)}))()},getRepoDetailReadme:function(e){var t=this;return i()(o.a.mark(function n(){var a;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(p.a)("/api/repos/".concat(e.owner,"/").concat(e.repo,"/readme"));case 2:(a=n.sent)&&a.content&&t.updateState({readmeContent:a.content});case 4:case"end":return n.stop()}},n,this)}))()},createRepo:function(e){return i()(o.a.mark(function t(){var n,a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.owner,t.next=3,Object(p.a)("/api/user/repos",{method:"POST",body:e});case 3:a=t.sent,l.a.push("".concat(n,"/").concat(a.name));case 5:case"end":return t.stop()}},t,this)}))()},getRepos:function(e){var t=this;return i()(o.a.mark(function n(){var a,s,c;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.owner,s=r()(e,["owner"]),n.next=3,Object(p.a)("/api/users/".concat(a,"/repos"),{body:s});case 3:c=n.sent,t.updateState({repos:c});case 5:case"end":return n.stop()}},n,this)}))()}}}},"./src/utils/request.js":function(e,t,n){"use strict";n.d(t,"a",function(){return u});var a=n("./node_modules/axios/index.js"),r=n.n(a),s=n("./node_modules/uiw/lib/index.js"),o=n("./src/history.js"),c=n("./src/utils/utils.js"),i={200:"服务器成功返回请求的数据。",201:"新建或修改数据成功。",202:"一个请求已经进入后台排队（异步任务）。",204:"删除数据成功。",400:"发出的请求有错误，服务器没有进行新建或修改数据的操作。",401:"用户没有权限（令牌、用户名、密码错误）。",403:"用户得到授权，但是访问是被禁止的。",404:"发出的请求针对的是不存在的记录，服务器没有进行操作。",406:"请求的格式不可得。",410:"请求的资源被永久删除，且不会再得到的。",422:"当创建一个对象时，发生一个验证错误。",500:"服务器发生错误，请检查服务器。",502:"网关错误。",503:"服务不可用，服务器暂时过载或维护。",504:"网关超时。"};function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.method||"GET",a={url:e,method:n,data:t.body,headers:{"Content-Type":"application/json; charset=utf-8",Accept:"application/json"}};return t.headers&&(a.headers=Object.assign({},a.headers,t.headers)),/(GET|DELETE)/.test(n)&&(a.url=Object(c.b)(e,Object.assign({},t.body)),delete a.body),r.a.request(a).then(function(e){return e.data}).catch(function(e){var t=e.response,n="string"==typeof t.data?t.data:"string"==typeof t.data.message?t.data.message:void 0;if(t.status>=200&&t.status<300)return t;if(401===t.status&&"/login"!==location.pathname)return s.Message.error(t.data?n:"请求失败！",{duration:4}),o.a.push("/login"),t.data;if(403!==t.status)if(t.status<=504&&t.status>=500)o.a.push("/exception/500");else if(t.status>=404&&t.status<422)o.a.push("/exception/404");else{var a=n||i[t.status]||t.statusText;if(!a){var r=new Error(a);if(r.name=t.status,r.response=t,t.data)return t.data;throw r}s.Notification.error({message:"错误提示：",description:a})}else o.a.push("/exception/403")})}},"./src/utils/utils.js":function(e,t,n){"use strict";function a(e,t){var n=e,a=[];return Object.keys(t).forEach(function(e){return a.push("".concat(e,"=").concat(t[e]))}),0===Object.keys(t).length?e:(!1===/\?/.test(n)?n="".concat(n,"?").concat(a.join("&")):n+="&".concat(a.join("&")),n)}function r(e){var t=e.split("/").filter(function(e){return e});return t.map(function(e,n){return{name:e,path:"/".concat(t.slice(0,n+1).join("/"))}})}function s(e){if(0===e)return"0 B";var t=Math.floor(Math.log(e)/Math.log(1e3)),n=(e/Math.pow(1e3,t)).toPrecision(3);return"".concat(parseFloat(n)," ").concat(["B","KB","MB","GB","TB","PB","EB","ZB","YB"][t])}n.d(t,"b",function(){return a}),n.d(t,"c",function(){return r}),n.d(t,"a",function(){return s})}}]);